<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <title>Too Green To Go â€” Energy-Aware GPU Arbitrage</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Tailwind via CDN for hackathon speed -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              'tg-green': { 50: '#ecfdf5', 100: '#d1fae5', 200: '#a7f3d0', 300: '#6ee7b7', 400: '#34d399', 500: '#10b981', 600: '#059669', 700: '#047857', 800: '#065f46', 900: '#064e3b' },
              'tg-dark': { 700: '#1e293b', 800: '#0f172a', 900: '#020617' }
            }
          }
        }
      }
    </script>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <style>
      @keyframes pulse-green { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
      .pulse-green { animation: pulse-green 2s ease-in-out infinite; }
      @keyframes slide-in { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
      .slide-in { animation: slide-in 0.3s ease-out; }
      .grid-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(16,185,129,0.15); }
      .grid-card { transition: all 0.2s ease; }
    </style>
  </head>

  <body class="bg-tg-dark-900 text-gray-100 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-tg-dark-800 border-b border-gray-700/50 sticky top-0 z-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center space-x-4">
            <a href="/" class="flex items-center space-x-2">
              <div class="w-8 h-8 bg-tg-green-500 rounded-lg flex items-center justify-center">
                <span class="text-white font-bold text-sm">âš¡</span>
              </div>
              <span class="text-lg font-bold text-tg-green-400">Too Green To Go</span>
            </a>
            <div class="hidden md:flex items-center space-x-1 ml-8">
              <%= link_to "Dashboard", dashboard_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
              <%= link_to "Workloads", workloads_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
              <%= link_to "Nodes", compute_nodes_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
              <%= link_to "Providers", providers_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
              <%= link_to "Grid Map", live_map_grid_states_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
              <%= link_to "Sustainability", sustainability_dashboard_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
              <%= link_to "Admin", admin_dashboard_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
              <%= link_to "Alerts", curtailment_events_path, class: "px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-tg-green-400 hover:bg-tg-dark-700 transition" %>
            </div>
          </div>
          <div class="flex items-center space-x-3">
            <!-- Demo Controls -->
            <div class="flex items-center space-x-2">
              <%= button_to "âš¡ Grid Cycle", demo_simulate_grid_cycle_path, method: :post, class: "px-2 py-1 text-xs bg-tg-green-600 hover:bg-tg-green-500 text-white rounded transition font-medium" %>
              <%= button_to "ðŸš€ New Workload", demo_simulate_workload_path, method: :post, class: "px-2 py-1 text-xs bg-blue-600 hover:bg-blue-500 text-white rounded transition font-medium" %>
              <%= button_to "ðŸ”„ Reroute", demo_simulate_reroute_path, method: :post, class: "px-2 py-1 text-xs bg-yellow-600 hover:bg-yellow-500 text-white rounded transition font-medium" %>
              <%= button_to "ðŸ”´ Curtailment", demo_simulate_curtailment_path, method: :post, class: "px-2 py-1 text-xs bg-red-600 hover:bg-red-500 text-white rounded transition font-medium" %>
              <%= button_to "ðŸ©º Health", demo_simulate_health_migration_path, method: :post, class: "px-2 py-1 text-xs bg-purple-600 hover:bg-purple-500 text-white rounded transition font-medium" %>
              <%= button_to "ðŸ”ª Slice", demo_simulate_slicing_path, method: :post, class: "px-2 py-1 text-xs bg-indigo-600 hover:bg-indigo-500 text-white rounded transition font-medium" %>
              <%= button_to "âœ… Complete", demo_simulate_completion_path, method: :post, class: "px-2 py-1 text-xs bg-emerald-600 hover:bg-emerald-500 text-white rounded transition font-medium" %>
            </div>
            <span class="text-xs text-gray-500 border-l border-gray-700 pl-3">Hackathon Demo</span>
          </div>
        </div>
      </div>
    </nav>

    <!-- Flash Messages -->
    <% if notice %>
      <div class="max-w-7xl mx-auto px-4 mt-2">
        <div class="bg-tg-green-900/50 border border-tg-green-700 text-tg-green-300 px-4 py-2 rounded-lg text-sm slide-in">
          <%= notice %>
        </div>
      </div>
    <% end %>
    <% if alert %>
      <div class="max-w-7xl mx-auto px-4 mt-2">
        <div class="bg-red-900/50 border border-red-700 text-red-300 px-4 py-2 rounded-lg text-sm slide-in">
          <%= alert %>
        </div>
      </div>
    <% end %>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <%= yield %>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-800 mt-12 py-6 text-center text-xs text-gray-600">
      <p>Too Green To Go Â© 2026 â€” Energy-Aware GPU Arbitrage Platform</p>
      <p class="mt-1">Built with Rails â€¢ Crusoe â€¢ Solana â€¢ Stripe â€¢ ElevenLabs â€¢ incident.io â€¢ Paid.ai â€¢ OpenShift AI</p>
    </footer>
  </body>
</html>
