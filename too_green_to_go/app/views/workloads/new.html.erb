<div class="max-w-2xl mx-auto">
  <h1 class="text-2xl font-bold text-white mb-6">Submit New Workload</h1>

  <div class="bg-tg-dark-800 rounded-xl border border-gray-700/50 p-6">
    <%= form_with(model: @workload, class: "space-y-4") do |form| %>
      <% if @workload.errors.any? %>
        <div class="bg-red-900/50 border border-red-700 text-red-300 p-3 rounded-lg text-sm">
          <% @workload.errors.full_messages.each do |msg| %>
            <p><%= msg %></p>
          <% end %>
        </div>
      <% end %>

      <div>
        <%= form.label :organization_id, "Organization", class: "block text-sm text-gray-400 mb-1" %>
        <%= form.select :organization_id, @organizations.map { |o| [o.name, o.id] }, {}, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm" %>
      </div>

      <div>
        <%= form.label :name, class: "block text-sm text-gray-400 mb-1" %>
        <%= form.text_field :name, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "My ML Training Job" %>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <%= form.label :workload_type, "Type", class: "block text-sm text-gray-400 mb-1" %>
          <%= form.select :workload_type, %w[inference training embedding fine_tune batch_inference], {}, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm" %>
        </div>
        <div>
          <%= form.label :priority, class: "block text-sm text-gray-400 mb-1" %>
          <%= form.select :priority, [["Urgent", "urgent"], ["Normal", "normal"], ["Async (Green Only)", "async"]], {}, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm" %>
        </div>
      </div>

      <div>
        <%= form.label :docker_image, "Docker Image", class: "block text-sm text-gray-400 mb-1" %>
        <%= form.text_field :docker_image, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "huggingface/transformers:latest" %>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <%= form.label :required_vram_mb, "Required VRAM (MB)", class: "block text-sm text-gray-400 mb-1" %>
          <%= form.number_field :required_vram_mb, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "24576" %>
        </div>
        <div>
          <%= form.label :estimated_duration_hours, "Est. Duration (hours)", class: "block text-sm text-gray-400 mb-1" %>
          <%= form.number_field :estimated_duration_hours, step: 0.1, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "2.0" %>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <%= form.label :max_carbon_intensity, "Max Carbon (gCOâ‚‚/kWh)", class: "block text-sm text-gray-400 mb-1" %>
          <%= form.number_field :max_carbon_intensity, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "200" %>
        </div>
        <div>
          <%= form.label :max_price_per_hour, "Max Price (â‚¬/hr)", class: "block text-sm text-gray-400 mb-1" %>
          <%= form.number_field :max_price_per_hour, step: 0.01, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "3.00" %>
        </div>
      </div>

      <div class="flex items-center space-x-2">
        <%= form.check_box :green_only, class: "rounded bg-tg-dark-700 border-gray-600 text-tg-green-500" %>
        <%= form.label :green_only, "ðŸŒ¿ Green Only â€” Route exclusively to nodes with >50% renewable energy", class: "text-sm text-gray-400" %>
      </div>

      <div>
        <%= form.label :green_tier, "Green Tier", class: "block text-sm text-gray-400 mb-1" %>
        <%= form.select :green_tier, [
          ["Standard â€” Best price/performance", "standard"],
          ["Green Preferred â€” Prefer renewable nodes", "green_preferred"],
          ["100% Recycled â€” Only energy recycler nodes", "100_pct_recycled"]
        ], {}, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm" %>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <%= form.label :budget_max_eur, "Max Budget (â‚¬)", class: "block text-sm text-gray-400 mb-1" %>
          <%= form.number_field :budget_max_eur, step: 0.01, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "50.00" %>
        </div>
        <div>
          <%= form.label :checkpoint_interval_minutes, "Checkpoint Interval (min)", class: "block text-sm text-gray-400 mb-1" %>
          <%= form.number_field :checkpoint_interval_minutes, class: "w-full bg-tg-dark-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm", placeholder: "30" %>
        </div>
      </div>

      <div class="flex items-center space-x-2">
        <%= form.check_box :checkpoint_enabled, class: "rounded bg-tg-dark-700 border-gray-600 text-blue-500" %>
        <%= form.label :checkpoint_enabled, "ðŸ”„ Enable Checkpointing â€” Pre-emptive saves for live migration support", class: "text-sm text-gray-400" %>
      </div>

      <div class="pt-4">
        <%= form.submit "Submit Workload", class: "w-full px-4 py-2 bg-tg-green-600 hover:bg-tg-green-500 text-white font-medium rounded-lg transition cursor-pointer" %>
      </div>
    <% end %>
  </div>
</div>
